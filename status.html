<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>River Valley Metro ‚Äî Weather Tracker</title>

<style>
:root {
  --rv-blue:#3FA9F5;
  --rv-mid:#0b5fc1;
  --black:#000;
  --white:#fff;
}

/* ---------- GLOBAL ---------- */
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow-x: hidden;
  font-family: 'Segoe UI', sans-serif;
}

/* ---------- 9:16 PORTRAIT FRAME ---------- */
.portrait-frame {
  width: 100vw;
  max-width: 430px;          /* iPhone Pro Max width */
  aspect-ratio: 9 / 16;
  margin: 0 auto;
  overflow-y: auto;
  overflow-x: hidden;
  background: linear-gradient(to bottom, var(--rv-mid), var(--rv-blue));
  position: relative;
}

/* ---------- HEADER ---------- */
header {
  text-align: center;
  background: var(--rv-mid);
  color: var(--white);
  padding: 16px 0;
  font-size: 24px;
  font-weight: bold;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  position: sticky;
  top: 0;
  z-index: 5;
}

/* ---------- CONTENT CARD ---------- */
.container {
  margin: 24px auto;
  width: 90%;
  max-width: 400px;
  background: rgba(255,255,255,0.92);
  padding: 22px;
  border-radius: 18px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.25);
  text-align: center;
}

.section-title {
  font-size: 20px;
  font-weight: bold;
  margin-bottom: 10px;
  color: var(--rv-mid);
}

#weather-info {
  font-size: 17px;
}

#free-status {
  margin-top: 14px;
  font-size: 19px;
  font-weight: bold;
}

/* ---------- BUTTON ---------- */
button {
  width: 100%;
  background: var(--rv-mid);
  color: var(--white);
  font-size: 17px;
  padding: 12px 0;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  margin-top: 18px;
}

/* ---------- ANIMATION LAYER ---------- */
#animation {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 0;
}

.sun, .moon {
  position: absolute;
  top: 10%;
  left: 50%;
  transform: translateX(-50%);
  font-size: 88px;
  opacity: 0.8;
}

.raindrop, .snowflake {
  position: absolute;
  animation: fall linear infinite;
}

.raindrop {
  font-size: 22px;
  color: #0b5fc1;
  animation-duration: 2.5s;
}

.snowflake {
  font-size: 22px;
  color: white;
  animation-duration: 5s;
}

@keyframes fall {
  from { transform: translateY(-10vh); }
  to { transform: translateY(110vh); }
}
</style>
</head>

<body>

<div class="portrait-frame">

<header>River Valley Metro ‚Äî Weather Tracker</header>

<div class="container">
  <div class="section-title">Current Weather</div>
  <div id="weather-info">Loading weather...</div>

  <div class="section-title">Fare Status</div>
  <div id="free-status">Checking...</div>

  <button onclick="checkFreeStatus()">Check Route Status</button>
</div>

<div id="animation"></div>

</div>

<script>
const weatherBox = document.getElementById("weather-info");
const freeStatus = document.getElementById("free-status");
const animationBox = document.getElementById("animation");

async function fetchWeather() {
  try {
    const response = await fetch(
      "https://api.open-meteo.com/v1/forecast?latitude=41.1201&longitude=-87.8612¬§t_weather=true&timezone=America/Chicago"
    );

    const data = await response.json();
    const weather = data.current_weather;
    if (!weather) throw new Error("Weather data missing");

    const tempF = (weather.temperature * 9/5) + 32;
    const windMph = weather.windspeed * 0.621371;
    const code = weather.weathercode;
    const hour = new Date().getHours();
    const time = new Date().toLocaleTimeString("en-US", { timeZone: "America/Chicago" });

    weatherBox.innerHTML = `
      <p><strong>Time:</strong> ${time}</p>
      <p><strong>Temperature:</strong> ${tempF.toFixed(1)} ¬∞F</p>
      <p><strong>Wind:</strong> ${windMph.toFixed(1)} mph</p>
    `;

    renderAnimation(code, hour);
    checkFreeStatus(tempF);

  } catch (e) {
    weatherBox.textContent = "‚ö†Ô∏è Weather unavailable";
  }
}

function renderAnimation(code, hour) {
  animationBox.innerHTML = "";
  const isNight = hour >= 18 || hour < 6;

  if (code >= 51 && code <= 67) {
    for (let i = 0; i < 40; i++) {
      const d = document.createElement("div");
      d.className = "raindrop";
      d.textContent = "üíß";
      d.style.left = Math.random() * 100 + "vw";
      d.style.animationDelay = Math.random() * 2 + "s";
      animationBox.appendChild(d);
    }
  } else if (code >= 71 && code <= 77) {
    for (let i = 0; i < 35; i++) {
      const s = document.createElement("div");
      s.className = "snowflake";
      s.textContent = "‚ùÑÔ∏è";
      s.style.left = Math.random() * 100 + "vw";
      s.style.animationDelay = Math.random() * 4 + "s";
      animationBox.appendChild(s);
    }
  } else {
    animationBox.innerHTML = isNight
      ? `<div class="moon">üåô</div>`
      : `<div class="sun">‚òÄÔ∏è</div>`;
  }
}

function checkFreeStatus(tempF = null) {
  const day = new Date().toLocaleString("en-US", {
    weekday: "long",
    timeZone: "America/Chicago"
  });

  if (day === "Monday") {
    freeStatus.textContent = "‚úÖ Free Ride Monday!";
    freeStatus.style.color = "#0a8f3a";
    return;
  }

  if (tempF !== null && tempF <= 0) {
    freeStatus.textContent = "‚úÖ Free Rides Due to Extreme Cold!";
    freeStatus.style.color = "#0a8f3a";
  } else {
    freeStatus.textContent = "Standard Fares Apply";
    freeStatus.style.color = "#d40000";
  }
}

fetchWeather();
setInterval(fetchWeather, 300000);
</script>
<nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-lg border-t border-gray-200 px-2 py-3 z-[2000] flex justify-around items-center shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
  
  <a href="index.html" id="nav-home" class="nav-item flex flex-col items-center gap-1 transition-all duration-300 text-gray-400 hover:text-metro-blue">
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    <span class="text-[10px] font-bold uppercase tracking-wider">Home</span>
  </a>

  <a href="tracker.html" id="nav-tracker" class="nav-item flex flex-col items-center gap-1 transition-all duration-300 text-gray-400 hover:text-metro-blue">
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>
    <span class="text-[10px] font-bold uppercase tracking-wider">Tracker</span>
  </a>

  <a href="midway.html" id="nav-midway" class="nav-item flex flex-col items-center gap-1 transition-all duration-300 text-gray-400 hover:text-metro-blue">
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M10 2v1.5h4V2h2v1.5h.5c1.1 0 2 .9 2 2v13c0 1.1-.9 2-2 2h-13c-1.1 0-2-.9-2-2v-13c0-1.1.9-2 2-2h.5V2h2v1.5h4V2h2zm3 8h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 0H7v2h2v-2zm0 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
    <span class="text-[10px] font-bold uppercase tracking-wider">Midway</span>
  </a>

  <a href="tickets.html" id="nav-tickets" class="nav-item flex flex-col items-center gap-1 transition-all duration-300 text-gray-400 hover:text-metro-blue">
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
    <span class="text-[10px] font-bold uppercase tracking-wider">Tickets</span>
  </a>

  <a href="status.html" id="nav-status" class="nav-item flex flex-col items-center gap-1 transition-all duration-300 text-gray-400 hover:text-metro-blue">
    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-7.07 9.5l-1.79 1.79 1.41 1.41 1.79-1.79-1.41-1.41zM9 19H7v3h2v-3zm7 0h-2v3h2v-3z"/></svg>
    <span class="text-[10px] font-bold uppercase tracking-wider">Status</span>
  </a>

</nav>
</body>
</html>
